
# AI合同审查助手 - MVP原型设计计划

## 项目概述
基于您的验证方案，设计一套完整的AI合同审查助手MVP原型，支持"概念嗅探测试"和"绿野仙踪核心体验测试"两个验证阶段。

---

## 阶段一：概念验证Landing Page

### 1.1 首页（价值主张展示）
- **视觉风格**：深蓝色为主色调，配合金色/白色点缀，体现专业法务感
- **核心标语**："上传合同，1分钟获取风险报告"
- **信任元素**：数据安全承诺标识、合作律所背书（可选）、端到端加密说明
- **功能按钮**：
  - 「预约内测」→ 收集用户邮箱/手机号
  - 「查看样例报告」→ 跳转到交互式样例报告页面

### 1.2 样例报告页面（交互式预览）
- **报告结构**：
  - 📋 合同概览（类型、签约双方、关键日期）
  - ⚠️ 风险条款清单（按高/中/低分级，支持展开详情）
  - 💡 修改建议（每条建议包含理由说明）
  - ⚖️ 免责声明区
- **交互功能**：可点击展开条款详情，模拟真实报告体验

### 1.3 预约注册功能
- 邮箱/手机号收集表单
- 验证来源渠道追踪（UTM参数）
- 预约成功确认页面

---

## 阶段二：完整测试平台

### 2.1 用户系统
- **注册/登录**：邮箱注册 + 密码登录
- **用户角色**：测试用户、后台操作员、管理员
- **数据协议**：用户首次使用需签署数据保密与测试协议

### 2.2 合同上传界面
- **上传说明**：引导用户上传脱敏后的NDA或试用协议
- **选择合同类型**：NDA或试用协议
- **文件类型**：支持PDF格式
- **安全提示**：醒目的脱敏提醒和数据销毁承诺
- **上传状态**：实时进度反馈

### 2.3 我的合同列表
- 已提交合同的状态追踪（处理中/已完成）
- 历史报告查看入口
- 48小时自动删除倒计时显示

### 2.4 AI审查报告详情页
- **报告头部**：合同基本信息 + 整体风险评级
- **条款识别区**：高亮分类关键条款（保密期限、赔偿上限、违约责任等）
- **风险评估区**：按高/中/低分级展示风险点，可视化风险分布
- **修改建议区**：
  - 每条建议包含：问题描述 + 修改建议 + 理由说明
  - 用户可对每条建议选择「采纳」「拒绝」「需讨论」
  - 选择时需填写简短理由
- **免责声明**：醒目的AI生成提示和法律咨询建议

### 2.5 用户反馈收集
- 报告满意度评分（1-5星）
- 效率感知调查
- 付费意愿问卷
- 访谈预约入口

### 2.6 后台管理系统（运营人员使用）
- **待处理队列**：查看用户上传的合同
- **报告填写界面**：基于标准化模板填写审查报告
- **数据管理**：用户反馈数据汇总和导出

---

## 技术实现要点

### 后端功能（Lovable Cloud）
- **用户认证**：邮箱注册登录
- **文件存储**：安全的PDF上传和48小时自动删除
- **数据库**：用户信息、合同记录、审查报告、用户反馈
- **权限管理**：普通用户/操作员/管理员角色分离

### 安全措施
- 端到端文件加密传输
- 严格的RLS策略保护用户数据
- 48小时数据自动清理机制
- 操作日志记录

---

## 页面结构预览

```
/                    → Landing Page首页
/sample-report       → 样例报告预览（无需登录）
/auth                → 登录/注册
/agreement           → 数据协议签署
/dashboard           → 用户仪表盘（我的合同列表）
/upload              → 合同上传
/report/:id          → 审查报告详情 + 反馈收集
/admin               → 后台管理入口
/admin/queue         → 待处理合同队列
/admin/edit/:id      → 报告填写界面
/admin/analytics     → 数据分析面板
```

---

## 设计风格说明
- **主色调**：深海蓝 (#1e3a5f) + 专业金 (#c9a227)
- **辅助色**：纯白、浅灰、柔和渐变
- **字体**：专业衬线/非衬线组合，中文使用思源黑体风格
- **元素**：法律元素图标、盾牌安全标识、简洁现代的卡片式布局
- **交互**：流畅的过渡动画，专业而不花哨

---

## 🔧 待优化项清单（优先级排序）

### P0 - 核心功能缺失（影响验证闭环）

#### 1. 48小时文件自动清理机制
- **现状**：前端仅显示倒计时，后端无实际清理逻辑
- **方案**：创建定时 Edge Function，每小时扫描已过期合同，删除 Storage 文件并更新 DB 状态
- **涉及**：Edge Function + Cron 触发

#### 2. 协议签署流程守卫
- **现状**：Dashboard 和 Upload 页面未检查用户是否已签署协议
- **方案**：在 Dashboard/Upload 页面加载时检查 `profiles.agreement_signed`，未签署则重定向到 `/agreement`
- **涉及**：Dashboard.tsx, Upload.tsx

#### 3. 文件上传大小校验
- **现状**：前端提示"不超过20MB"但未做实际大小限制
- **方案**：在 `handleUpload` 中增加 `file.size` 校验，超过 20MB 拒绝上传
- **涉及**：Upload.tsx

#### 4. 忘记密码/重置密码功能
- **现状**：Auth 页面无密码找回入口
- **方案**：利用认证系统的 `resetPasswordForEmail` + 密码重置页面
- **涉及**：Auth.tsx, 新增 ResetPassword.tsx

### P1 - 体验优化（提升用户感知）

#### 5. 移动端响应式适配
- **现状**：Dashboard 合同列表、Admin 页面在小屏幕下布局拥挤
- **方案**：
  - Dashboard 合同卡片改为垂直堆叠布局
  - Admin 导航改为 Hamburger 菜单
  - Report 页面建议按钮改为垂直排列
- **涉及**：Dashboard.tsx, AdminQueue.tsx, Report.tsx, AdminAnalytics.tsx

#### 6. 公共 Header/Layout 组件提取
- **现状**：每个页面重复实现 header，代码冗余且风格不一致
- **方案**：提取 `AppHeader` 和 `AdminHeader` 共享布局组件
- **涉及**：新增 components/layout/AppHeader.tsx, AdminHeader.tsx

#### 7. Report.tsx 组件拆分
- **现状**：Report.tsx 已达 413 行，职责过多
- **方案**：拆分为 ReportHeader, RiskClauseList, SuggestionList, FeedbackForm 等子组件
- **涉及**：src/components/report/ 目录

#### 8. 全局错误边界与网络异常处理
- **现状**：多处 API 调用仅处理 happy path，网络断开或服务异常时无反馈
- **方案**：
  - 添加 React Error Boundary 组件
  - API 调用统一加 error toast 提示
  - 增加重试按钮
- **涉及**：新增 ErrorBoundary.tsx, 各数据请求页面

### P2 - 数据验证增强（支撑决策分析）

#### 9. Admin 数据分析增强
- **现状**：`totalUsers` 显示为 0（缺少 profiles 表的 admin 读取策略）、无趋势图表
- **方案**：
  - 添加 admin 可读 profiles 的 RLS 策略（仅 count）
  - 增加合同提交趋势图（按日/周）
  - 增加建议采纳/拒绝/讨论分布饼图
  - Waitlist 来源渠道分布图
- **涉及**：AdminAnalytics.tsx, DB RLS 策略

#### 10. 报告完成通知
- **现状**：用户需手动刷新 Dashboard 查看报告状态
- **方案**：
  - 方案A：利用 Realtime 订阅 contracts 状态变更，前端即时刷新
  - 方案B：报告完成时触发邮件通知（需 Edge Function + 邮件服务）
- **涉及**：Dashboard.tsx, 可选 Edge Function

#### 11. 管理员操作日志
- **现状**：无操作审计记录
- **方案**：创建 `admin_audit_logs` 表，记录报告创建/编辑/状态变更操作
- **涉及**：DB migration, AdminReportEditor.tsx

### P3 - SEO与营销优化

#### 12. Landing Page SEO 优化
- **现状**：index.html 缺少完整的 meta tags、OG 标签
- **方案**：
  - 添加 title、description、keywords meta 标签
  - 添加 OG 和 Twitter Card 标签
  - 添加 JSON-LD 结构化数据
- **涉及**：index.html

#### 13. Landing Page A/B 测试支持
- **现状**：无法区分不同文案/设计的转化效果
- **方案**：通过 URL 参数控制不同版本的 Hero Section 文案，结合 UTM 追踪转化
- **涉及**：HeroSection.tsx, waitlist 表

---

## 实施建议

按 P0 → P1 → P2 → P3 顺序逐步优化，每完成一组后进行端到端测试验证。P0 项直接影响 MVP 验证的完整性，应优先处理。
